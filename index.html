<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Угадай мелодию</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f0f0f0;
        }
        button {
            padding: 10px;
            margin: 5px;
            width: 200px;
            cursor: pointer;
        }
        #playButton {
            background-color: #1a73e8;
            color: white;
        }
        #startScreen {
            display: block;
        }
        #gameScreen {
            display: none;
        }
    </style>
</head>
<body>
    <div id="startScreen">
        <h1>Угадай мелодию</h1>
        <button id="playButton" onclick="startGame()">Играть</button>
    </div>
    <div id="gameScreen">
        <h1>Угадай мелодию</h1>
        <p>Выбери правильный ответ:</p>
        <div id="options">
            <button onclick="checkAnswer(0)">Вариант 1</button><br>
            <button onclick="checkAnswer(1)">Вариант 2</button><br>
            <button onclick="checkAnswer(2)">Вариант 3</button>
        </div>
        <p id="result"></p>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const melodies = [
            { name: "Баста - Моя игра", url: "https://Likkich.github.io/VibeQuessBot/audio/Basta.mp3" },
            { name: "Бурито - Мама", url: "https://Likkich.github.io/VibeQuessBot/audio/burito-mama.mp3" },
            { name: "Инстасамка - За деньги да", url: "https://Likkich.github.io/VibeQuessBot/audio/ZaDengi.mp3" }
        ];

        let currentMelody = Math.floor(Math.random() * melodies.length);
        let audio = new Audio();
        let options = [];

        function startGame() {
            // Скрываем стартовый экран, показываем игру
            document.getElementById("startScreen").style.display = "none";
            document.getElementById("gameScreen").style.display = "block";
            // Запускаем мелодию
            audio.src = melodies[currentMelody].url;
            audio.play();
            // Генерируем варианты
            options = generateOptions();
            let buttons = document.querySelectorAll("#options button");
            buttons.forEach((btn, index) => btn.innerText = options[index]);
        }

        function generateOptions() {
            let opts = [melodies[currentMelody].name];
            while (opts.length < 3) {
                let randomMelody = melodies[Math.floor(Math.random() * melodies.length)].name;
                if (!opts.includes(randomMelody)) opts.push(randomMelody);
            }
            return opts.sort(() => Math.random() - 0.5);
        }

        function checkAnswer(index) {
            let user = Telegram.WebApp.initDataUnsafe.user;
            let result = document.getElementById("result");
            if (options[index] === melodies[currentMelody].name) {
                result.innerText = `Правильно, ${user.first_name}! Это "${melodies[currentMelody].name}"`;
                Telegram.WebApp.showAlert("Молодец! Начать заново?");
                resetGame();
            } else {
                result.innerText = "Неправильно, попробуй ещё раз!";
            }
        }

        function resetGame() {
            currentMelody = Math.floor(Math.random() * melodies.length);
            options = generateOptions();
            let buttons = document.querySelectorAll("#options button");
            buttons.forEach((btn, index) => btn.innerText = options[index]);
            audio.pause();
            document.getElementById("result").innerText = "";
            document.getElementById("gameScreen").style.display = "none";
            document.getElementById("startScreen").style.display = "block";
        }
    </script>
</body>
</html>
